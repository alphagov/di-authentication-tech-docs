---
title: Integrate with Authorization Code Flow
weight: 5.5
last_reviewed_on: 2021-09-08
review_in: 6 months
---

# Integrate with Authorization Code Flow

To get an access token which will allow you to access basic user information, you’ll need to integrate with [OAuth’s Authorization Code Flow](https://openid.net/specs/openid-connect-core-1_0.html).

We recommend you [use a certified OpenID Connect (OIDC) client library](https://openid.net/developers/certified/) rather than building your own.

## Use the discovery endpoint

You can use the [discovery endpoint](https://OIDC_PLACEHOLDER_DOMAIN/.well-known/openid-configuration) to get information needed to interact with GOV.UK Sign in, for example:

* issuer name
* information about the keys
* supported scopes

## Make an authorisation request

To make an authorisation request, your application should first send the user to the authorisation URL. To send the user to the authorisation URL, run this command and follow the guidance in the following table to replace the placeholder values.


```
HTTP/1.1 302 Found
Location: https://OIDC_PLACEHOLDER_DOMAIN/authorize?
response_type=code
&scope=YOUR_SCOPES
&client_id=YOUR_CLIENT_ID
&state=STATE &
redirect_uri=YOUR_REDIRECT_URI
```

<table class="tg">
<thead>
  <tr>
    <th class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Parameter</span></th>
    <th class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Required or optional</span></th>
    <th class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Description</span></th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0pky">response_type</td>
    <td class="tg-0pky">Required</td>
    <td class="tg-0pky">You must set this value to be code: <code>response_type=code</code>.</td>
  </tr>
  <tr>
    <td class="tg-0pky">scope</td>
    <td class="tg-0pky">Required</td>
    <td class="tg-0pky">A space-separated list of scopes. You must include <code>openid</code> scope value.<br>You should refer to the guidance on <a href="/select-supported-scopes/#select-supported-scopes"><span>supported scopes you can select</span></a> for the <code>scope</code> parameter. </td>
  </tr>
  <tr>
    <td class="tg-0pky">client_id</td>
    <td class="tg-0pky">Required</td>
    <td class="tg-0pky">You’ll have set your <code>client_ID</code> when you <a href="/manage-your-service-to-use-OIDC-provider/#register-your-service-to-use-gov-uk-sign-in"><span>registered your service to use GOV.UK Sign in</span></a>. </td>
  </tr>
  <tr>
    <td class="tg-0pky">state</td>
    <td class="tg-0pky">Required </td>
    <td class="tg-0pky">When you receive a response at the redirect URL, there must be a way to verify the response came for a request which you sent. The <code>state</code> value solves this issue by binding the request and response, which reduces impact of <a href="https://owasp.org/www-community/attacks/csrf"><span>Cross Site Request Forgery</span></a> attacks.<br>This value will be returned to the client in the authentication response.</td>
  </tr>
  <tr>
    <td class="tg-0pky">redirect_uri</td>
    <td class="tg-0pky">Required</td>
    <td class="tg-0pky">You’ll have specified your <code>redirect_uri</code> when you <a href="/manage-your-service-to-use-OIDC-provider/#register-your-service-to-use-gov-uk-sign-in"><span>registered your service to use GOV.UK Sign in</span></a>.<br>The redirect URI must exactly match one of the redirect URIs you registered for using Dynamic Client Registration, except that it must be URL-encoded.</td>
  </tr>
  <tr>
    <td class="tg-0pky">nonce</td>
    <td class="tg-0pky">Required </td>
    <td class="tg-0pky">A unique value generated by your application that is used to verify the integrity of the <code>id_token</code> and mitigate replay attacks. <br>This value will be present in the <code>id_token</code> and should include the per-session state, as well as being impossible for attackers to guess. <br>Your application will need to verify the <code>nonce</code> claim value is the same as the <code>nonce</code> parameter sent in the authentication request.</td>
  </tr>
  <tr>
    <td class="tg-0pky">prompt</td>
    <td class="tg-0pky">Optional<br></td>
    <td class="tg-0pky">GOV.UK Sign in supports the <code>login</code> parameter. This will always force your users to re-authenticate even if they have an existing session. <br>If you use the <code>prompt</code> parameter, your users will be prompted to authenticate. <br>If you do not use the <code>prompt</code> parameter, your service will silently authenticate your users if they have an existing session.</td>
  </tr>
</tbody>
</table>

### Generate an authorisation code

If your user does not have an existing session they’re signed in to when your service makes the authorisation request, the OIDC sign-in page will open. Your user can enter their details on this page to authenticate themselves.

If your user has an existing session, or after they authenticate, they will be redirected to the `redirect_uri` your service specified.

The authorisation code generated by your user’s session can be used once and displays in the query string of the URL, for example:

```
HTTP/1.1 302 Found
Location: https://REDIRECT_URI?code=AUTHORIZATION_CODE&state=xyzABC123&nonce=3jjd8
```

If your authorisation request included the parameters for `state` and `nonce`, the URI will also include these parameters.

### Error handling for ‘Make an authorisation request’

To understand more about what the error is, you can look in the response. Depending on the type of error you receive, the response may contain an `error` and an `error_description` which will provide you with information.

If there’s an error in your request, you’ll be redirected to the URI you specified for `redirect_uri` in the authorisation URL. You’ll be able to see the error description tagged onto the end of the authorisation URL, for example:

```
HTTP/1.1 302 Found
Location: https://REDIRECT_URI?
error=invalid_request
&error_description=Unsupported%20response
&state=1234
```

<table class="tg">
<thead>
  <tr>
    <th class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Error</span></th>
    <th class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">More information about your error</span></th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">unauthorized_client</span></td>
    <td class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Your service is not authorised to request an authorisation code.</span><br><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Make sure you have </span><a href="/manage-your-service-to-use-OIDC-provider/#register-your-service-to-use-gov-uk-sign-in"><span>registered your service to use GOV.UK Sign in</span></a><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">.</span></td>
  </tr>
  <tr>
    <td class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">invalid_request</span></td>
    <td class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">The request has one or more of the following issues:  </span>
      <li style="font-weight: 400;"><span style="font-weight: 400;">missing a required parameter</span></li>
      <li style="font-weight: 400;"><span style="font-weight: 400;">includes an invalid parameter value</span></li>
      <li style="font-weight: 400;"><span style="font-weight: 400;">includes a parameter more than once</span></li>
      <li style="font-weight: 400;"><span style="font-weight: 400;">not in the correct format</span></li>
      You can </span><a href="/integrate-with-code-flow/#make-an-authorisation-request"><span>check which parameters GOV.UK Sign in supports when you make an authorisation request</span></a>.
</td>
  </tr>
  <tr>
    <td class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">invalid_scope</span></td>
    <td class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">The scope or scopes you have requested are invalid, unknown, or are not in the correct format.</span><br><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">You can read more about <a href="/select-supported-scopes/#select-supported-scopes"><span>supported scopes you can select</span></a>.</span></td>
  </tr>
  <tr>
    <td class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">unsupported_response_type</span></td>
    <td class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Your service is not registered for the requested <code>response_type</code>. </span><br><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">You must set the <code>response type</code> to be code, for example <code>response_type=code</code>.</span></td>
  </tr>
  <tr>
    <td class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">server_error</span></td>
    <td class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">The GOV.UK Sign in authentication server has experienced an internal server error and will return the HTTP status code <code>500</code>.</span></td>
  </tr>
  <tr>
    <td class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">temporarily_unavailable</span></td>
    <td class="tg-0pky"><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">The GOV.UK Sign in authentication server is temporarily unavailable, which might be caused by temporary overloading or planned maintenance. </span><br><span style="font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent">Make your authorisation request again in a few minutes.</span></td>
  </tr>
</tbody>
</table>
